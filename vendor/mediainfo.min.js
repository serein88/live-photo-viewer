!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports):"function"==typeof define&&define.amd?define(["exports"],t):t((e="undefined"!=typeof globalThis?globalThis:e||self).MediaInfo={})}(this,function(e){"use strict";var t="undefined"!=typeof document?document.currentScript:null;function n(e){return function(e){return null!==e&&"object"==typeof e&&Object.prototype.hasOwnProperty.call(e,"message")}(e)?e:new Error("string"==typeof e?e:"Unknown error")}const i=["Active_Height","Active_Width","AudioCount","Audio_Channels_Total","BitDepth_Detected","BitDepth","BitDepth_Stored","Channels","Channels_Original","Chapters_Pos_Begin","Chapters_Pos_End","Comic_Position_Total","Count","DataSize","ElementCount","EPG_Positions_Begin","EPG_Positions_End","FirstPacketOrder","FooterSize","Format_Settings_GMC","Format_Settings_RefFrames","Format_Settings_SliceCount","FrameCount","FrameRate_Den","FrameRate_Num","GeneralCount","HeaderSize","Height_CleanAperture","Height","Height_Offset","Height_Original","ImageCount","Lines_MaxCharacterCount","Lines_MaxCountPerEvent","Matrix_Channels","MenuCount","OtherCount","Part_Position","Part_Position_Total","Played_Count","Reel_Position","Reel_Position_Total","Resolution","Sampled_Height","Sampled_Width","SamplingCount","Season_Position","Season_Position_Total","Source_FrameCount","Source_SamplingCount","Source_StreamSize_Encoded","Source_StreamSize","Status","Stored_Height","Stored_Width","StreamCount","StreamKindID","StreamKindPos","StreamSize_Demuxed","StreamSize_Encoded","StreamSize","TextCount","Track_Position","Track_Position_Total","Video0_Delay","VideoCount","Width_CleanAperture","Width","Width_Offset","Width_Original"],r=["Active_DisplayAspectRatio","BitRate_Encoded","BitRate_Maximum","BitRate_Minimum","BitRate","BitRate_Nominal","Bits-Pixel_Frame","BitsPixel_Frame","Compression_Ratio","Delay","Delay_Original","DisplayAspectRatio_CleanAperture","DisplayAspectRatio","DisplayAspectRatio_Original","Duration_End_Command","Duration_End","Duration_FirstFrame","Duration_LastFrame","Duration","Duration_Start2End","Duration_Start_Command","Duration_Start","Events_MinDuration","FrameRate_Maximum","FrameRate_Minimum","FrameRate","FrameRate_Nominal","FrameRate_Original_Den","FrameRate_Original","FrameRate_Original_Num","FrameRate_Real","Interleave_Duration","Interleave_Preload","Interleave_VideoFrames","MasteringDisplay_Luminance_Max","MasteringDisplay_Luminance_Min","MaxCLL","MaxCLL_Original","MaxFALL","MaxFALL_Original","OverallBitRate_Maximum","OverallBitRate_Minimum","OverallBitRate","OverallBitRate_Nominal","PixelAspectRatio_CleanAperture","PixelAspectRatio","PixelAspectRatio_Original","SamplesPerFrame","SamplingRate","Source_Duration_FirstFrame","Source_Duration_LastFrame","Source_Duration","TimeStamp_FirstFrame","Video_Delay"],a={coverData:!1,chunkSize:262144,format:"object",full:!1};class o{isAnalyzing=!1;constructor(e,t){this.mediainfoModule=e,this.options=t,this.ptr=this.instantiateModuleInstance()}analyzeData(e,t,i){if(void 0===i)return new Promise((i,r)=>{this.analyzeData(e,t,(e,t)=>{this.isAnalyzing=!1,t||!e?r(n(t)):i(e)})});if(this.isAnalyzing)return void i(null,new Error("cannot start a new analysis while another is in progress"));this.reset(),this.isAnalyzing=!0;const r=()=>{try{this.openBufferFinalize();const e=this.inform();"object"===this.options.format?i(this.parseResultJson(e)):i(e)}finally{this.isAnalyzing=!1}};let a=0;const o=e=>{const o=e=>{u(e)?s():r()},s=()=>{let r;try{const n=Math.min(this.options.chunkSize,e-a);r=t(n,a)}catch(e){return this.isAnalyzing=!1,void i(null,n(e))}r instanceof Promise?r.then(o).catch(e=>{this.isAnalyzing=!1,i(null,n(e))}):o(r)},u=t=>{if(0===t.length||this.openBufferContinue(t,t.length))return!1;const n=this.openBufferContinueGotoGet();return-1===n?a+=t.length:(a=n,this.openBufferInit(e,n)),!0};this.openBufferInit(e,a),s()},s="function"==typeof e?e():e;s instanceof Promise?s.then(o).catch(e=>{i(null,n(e))}):o(s)}close(){this.ptr&&this.mediainfoModule._mi_close(this.ptr)}reset(){this.ptr&&this.mediainfoModule._mi_delete(this.ptr),this.ptr=this.instantiateModuleInstance()}inform(){const e=this.mediainfoModule._mi_inform(this.ptr);return this.mediainfoModule.UTF8ToString(e)}openBufferContinue(e,t){const n=this.mediainfoModule._malloc(t);this.mediainfoModule.HEAPU8.set(e,n);const i=this.mediainfoModule._mi_open_buffer_continue(this.ptr,n,t);return this.mediainfoModule._free(n),!!(8&i)}openBufferContinueGotoGet(){const e=this.mediainfoModule._mi_open_buffer_continue_goto_get(this.ptr);return Number(e)}openBufferFinalize(){this.mediainfoModule._mi_open_buffer_finalize(this.ptr)}openBufferInit(e,t){this.mediainfoModule._mi_open_buffer_init(this.ptr,BigInt(e),BigInt(t))}parseResultJson(e){const t=i,n=r,a=JSON.parse(e);if(a.media){const e={...a.media,track:[]};if(Array.isArray(a.media.track))for(const i of a.media.track){let r={"@type":i["@type"]};for(const[e,a]of Object.entries(i))"@type"!==e&&(r="string"==typeof a&&t.includes(e)?{...r,[e]:Number.parseInt(a,10)}:"string"==typeof a&&n.includes(e)?{...r,[e]:Number.parseFloat(a)}:{...r,[e]:a});e.track.push(r)}return{...a,media:e}}return a}instantiateModuleInstance(){const e="object"===this.options.format?"JSON":this.options.format,t=this.mediainfoModule.lengthBytesUTF8(e)+1,n=this.mediainfoModule._malloc(t);try{return this.mediainfoModule.stringToUTF8(e,n,t),this.mediainfoModule._mi_new(n,this.options.coverData?1:0,this.options.full?1:0)}finally{this.mediainfoModule._free(n)}}}async function s(e={}){var n,i=e,r=(e,t)=>{throw t},a="undefined"==typeof document&&"undefined"==typeof location?require("url").pathToFileURL(__filename).href:"undefined"==typeof document?location.href:t&&"SCRIPT"===t.tagName.toUpperCase()&&t.src||new URL("index.min.js",document.baseURI).href,o="";try{o=new URL(".",a).href}catch{}n=async e=>{var t=await fetch(e,{credentials:"same-origin"});if(t.ok)return t.arrayBuffer();throw new Error(t.status+" : "+t.url)};var s,u,l,f,c,m,_,d=console.log.bind(console),h=console.error.bind(console),p=!1,g=!1;function y(){var e=C.buffer;i.HEAPU8=f=new Uint8Array(e),c=new Int32Array(e),m=new Uint32Array(e),new BigInt64Array(e),new BigUint64Array(e)}function v(e){i.onAbort?.(e),h(e="Aborted("+e+")"),p=!0,e+=". Build with -sASSERTIONS for more info.";var t=new WebAssembly.RuntimeError(e);throw l?.(t),t}function S(){return i.locateFile?(e="MediaInfoModule.wasm",i.locateFile?i.locateFile(e,o):o+e):new URL("MediaInfoModule.wasm","undefined"==typeof document&&"undefined"==typeof location?require("url").pathToFileURL(__filename).href:"undefined"==typeof document?location.href:t&&"SCRIPT"===t.tagName.toUpperCase()&&t.src||new URL("index.min.js",document.baseURI).href).href;var e}async function w(e,t){try{var i=await async function(e){try{var t=await n(e);return new Uint8Array(t)}catch{}return function(){throw"both async and sync fetching of the wasm failed"}()}(e);return await WebAssembly.instantiate(i,t)}catch(e){h(`failed to asynchronously prepare wasm: ${e}`),v(e)}}class M{name="ExitStatus";constructor(e){this.message=`Program terminated with exit(${e})`,this.status=e}}var b,C,F={},R=e=>{if(!p)try{e()}catch(e){(e=>{if(e instanceof M||"unwind"==e)return s;r(0,e)})(e)}},A=(e,t,n)=>((e,t,n,i)=>{if(!(i>0))return 0;for(var r=n,a=n+i-1,o=0;o<e.length;++o){var s=e.codePointAt(o);if(s<=127){if(n>=a)break;t[n++]=s}else if(s<=2047){if(n+1>=a)break;t[n++]=192|s>>6,t[n++]=128|63&s}else if(s<=65535){if(n+2>=a)break;t[n++]=224|s>>12,t[n++]=128|s>>6&63,t[n++]=128|63&s}else{if(n+3>=a)break;t[n++]=240|s>>18,t[n++]=128|s>>12&63,t[n++]=128|s>>6&63,t[n++]=128|63&s,o++}}return t[n]=0,n-r})(e,f,t,n),T=(e,t)=>Math.ceil(e/t)*t,D=e=>{var t=(e-C.buffer.byteLength+65535)/65536|0;try{return C.grow(t),y(),1}catch(e){}},P={},U=()=>{if(!U.strings){var e={USER:"web_user",LOGNAME:"web_user",PATH:"/",PWD:"/",HOME:"/home/web_user",LANG:(globalThis.navigator?.language??"C").replace("-","_")+".UTF-8",_:"./this.program"};for(var t in P)void 0===P[t]?delete e[t]:e[t]=P[t];var n=[];for(var t in e)n.push(`${t}=${e[t]}`);U.strings=n}return U.strings},B=e=>{for(var t=0,n=0;n<e.length;++n){var i=e.charCodeAt(n);i<=127?t++:i<=2047?t+=2:i>=55296&&i<=57343?(t+=4,++n):t+=3}return t},x=[null,[],[]],O=new TextDecoder,E=(e,t,n,i)=>{var r=t+n;if(i)return r;for(;e[t]&&!(t>=r);)++t;return t},z=(e,t)=>{var n=x[e];0===t||10===t?((1===e?d:h)(((e,t=0,n,i)=>{var r=E(e,t,n,i);return O.decode(e.buffer?e.subarray(t,r):new Uint8Array(e.slice(t,r)))})(n)),n.length=0):n.push(t)};i.print&&(d=i.print),i.printErr&&(h=i.printErr),i.UTF8ToString=(e,t,n)=>{if(!e)return"";var i=E(f,e,t,n);return O.decode(f.subarray(e,i))},i.stringToUTF8=A,i.lengthBytesUTF8=B;var I,L={l:()=>v(""),i:()=>{},d:function(e,t){var n;e=(n=e)<-9007199254740992||n>9007199254740992?NaN:Number(n);var i=new Date(1e3*e);c[t>>2]=i.getUTCSeconds(),c[t+4>>2]=i.getUTCMinutes(),c[t+8>>2]=i.getUTCHours(),c[t+12>>2]=i.getUTCDate(),c[t+16>>2]=i.getUTCMonth(),c[t+20>>2]=i.getUTCFullYear()-1900,c[t+24>>2]=i.getUTCDay();var r=Date.UTC(i.getUTCFullYear(),0,1,0,0,0,0),a=(i.getTime()-r)/864e5|0;c[t+28>>2]=a},j:(e,t)=>{if(F[e]&&(clearTimeout(F[e].id),delete F[e]),!t)return 0;var n=setTimeout(()=>{delete F[e],R(()=>b(e,performance.now()))},t);return F[e]={id:n,timeout_ms:t},0},e:(e,t,n,i)=>{var r=(new Date).getFullYear(),a=new Date(r,0,1),o=new Date(r,6,1),s=a.getTimezoneOffset(),u=o.getTimezoneOffset(),l=Math.max(s,u);m[e>>2]=60*l,c[t>>2]=Number(s!=u);var f=e=>{var t=e>=0?"-":"+",n=Math.abs(e);return`UTC${t}${String(Math.floor(n/60)).padStart(2,"0")}${String(n%60).padStart(2,"0")}`},_=f(s),d=f(u);u<s?(A(_,n,17),A(d,i,17)):(A(_,i,17),A(d,n,17))},k:()=>Date.now(),a:e=>{var t=f.length,n=2147483648;if((e>>>=0)>n)return!1;for(var i=1;i<=4;i*=2){var r=t*(1+.2/i);r=Math.min(r,e+100663296);var a=Math.min(n,T(Math.max(e,r),65536));if(D(a))return!0}return!1},b:(e,t)=>{var n=0,i=0;for(var r of U()){var a=t+n;m[e+i>>2]=a,n+=A(r,a,1/0)+1,i+=4}return 0},c:(e,t)=>{var n=U();m[e>>2]=n.length;var i=0;for(var r of n)i+=B(r)+1;return m[t>>2]=i,0},f:e=>52,g:(e,t,n,i)=>{for(var r=0,a=0;a<n;a++){var o=m[t>>2],s=m[t+4>>2];t+=8;for(var u=0;u<s;u++)z(e,f[o+u]);r+=s}return m[i>>2]=r,0},h:e=>{s=e,r(0,new M(e))}};return I=await async function(){function e(e,t){return function(e){i._mi_new=e.o,i._mi_delete=e.p,i._mi_open_buffer_init=e.q,i._mi_open_buffer_continue=e.r,i._mi_open_buffer_continue_goto_get=e.s,i._mi_open_buffer_finalize=e.t,i._mi_inform=e.u,i._mi_close=e.v,i._malloc=e.w,i._free=e.x,b=e.y,C=e.m,e.__indirect_function_table}(I=e.exports),y(),I}var t={a:L};return _??=S(),function(t){return e(t.instance)}(await async function(e,t,n){try{var i=fetch(t,{credentials:"same-origin"});return await WebAssembly.instantiateStreaming(i,n)}catch(e){h(`wasm streaming compile failed: ${e}`),h("falling back to ArrayBuffer instantiation")}return w(t,n)}(0,_,t))}(),i.calledRun=!0,p||(g=!0,I.n(),u?.(i)),g?i:new Promise((e,t)=>{u=e,l=t})}const u=()=>{};function l(e,t){try{if("/"===new URL(t).pathname)return`${t}mediainfo.js/dist/${e}`}catch{}return`${t}../${e}`}function f(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0,n=arguments.length>2?arguments[2]:void 0;if(void 0===t)return new Promise((t,n)=>{f(e,t,n)});const{locateFile:i,...r}={...a,...e,format:e.format??a.format};s({print:u,printErr:u,locateFile:i??l,onAbort:e=>{n&&n(e)}}).then(e=>{t(new o(e,r))}).catch(e=>{n&&n(e)})}e.default=f,e.isTrackType=function(e,t){return null!==e&&"object"==typeof e&&e["@type"]===t},e.mediaInfoFactory=f,Object.defineProperty(e,"__esModule",{value:!0})});
//# sourceMappingURL=index.min.js.map
